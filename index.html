
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFVT Team Followup - Enhanced Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@900&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

    <style>
        * { box-sizing: border-box; }
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%); 
            min-height: 100vh; margin: 0; padding: 20px; 
            animation: gradientShift 15s ease infinite;
            background-size: 400% 400%;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        #loginOverlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%); 
            display: flex; align-items: center; justify-content: center; z-index: 2000; 
        }
        
        .login-box { 
            background: white; padding: 35px; border-radius: 20px; text-align: center; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.3); width: 320px;
            animation: fadeInScale 0.5s ease-out;
        }
        
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .container { 
            max-width: 1400px; margin: auto; background: white; padding: 30px; 
            border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.2); 
            position: relative; display: none;
            animation: slideIn 0.6s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .user-profile-bar { 
            display: flex; align-items: center; justify-content: space-between; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            padding: 15px 25px; border-radius: 15px; margin-bottom: 25px; 
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }
        
        .user-details { display: flex; align-items: center; gap: 15px; }
        .user-avatar { 
            width: 50px; height: 50px; 
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); 
            color: #1a202c; border-radius: 50%; display: flex; align-items: center; 
            justify-content: center; font-weight: 900; font-size: 20px;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
        }
        
        .user-details div { color: white; }
        
        .language-toggle {
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s ease;
            margin-left: 10px;
        }
        
        .language-toggle:hover {
            background: rgba(255,255,255,0.3);
        }

        .stats-summary { 
            background: linear-gradient(135deg, #10b981 0%, #059669 100%); 
            padding: 20px; border-radius: 15px; font-weight: 800; color: white; 
            margin-bottom: 25px; text-align: center; font-size: 18px;
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        .header-section { text-align: center; margin-bottom: 30px; }
        .team-logo { 
            max-width: 120px; height: auto; border-radius: 15px; margin-bottom: 20px; 
            border: 3px solid #fbbf24; box-shadow: 0 8px 25px rgba(251, 191, 36, 0.4);
        }
        
        .luxury-gold-title {
            font-family: 'Playfair Display', serif; font-size: 42px; font-weight: 900; 
            margin: 0; text-transform: uppercase;
            background: linear-gradient(45deg, #bf953f 0%, #fcf6ba 20%, #b38728 45%, #fcf6ba 55%, #bf953f 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
            filter: drop-shadow(0px 2px 3px #947a39); 
            animation: lightSweep 3s infinite linear;
            background-size: 200% auto;
        }

        @keyframes lightSweep { 
            0% { background-position: 0% center; } 
            100% { background-position: 200% center; } 
        }

        .form-section { 
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); 
            padding: 25px; border-radius: 15px; border: 2px solid #3b82f6; 
            margin-bottom: 30px; box-shadow: 0 6px 20px rgba(59, 130, 246, 0.2);
        }
        
        .grid-form { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; }
        .input-group label { 
            display: block; font-size: 11px; font-weight: 800; color: #475569; 
            margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px;
        }
        
        input, select { 
            width: 100%; padding: 10px; border: 2px solid #cbd5e0; border-radius: 8px; 
            font-size: 14px; transition: all 0.3s ease;
        }
        
        input:focus, select:focus { 
            outline: none; border-color: #3b82f6; 
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .add-btn { 
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); 
            color: white; border: none; padding: 12px; border-radius: 8px; 
            font-weight: 700; cursor: pointer; align-self: flex-end;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
            transition: all 0.3s ease;
        }
        
        .add-btn:hover { 
            transform: translateY(-2px); 
        }
        
        .edit-btn {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 700;
            font-size: 11px;
            margin-right: 5px;
            transition: all 0.3s ease;
        }
        
        .edit-btn:hover {
            transform: scale(1.05);
        }
        
        .high-pv { 
            background: linear-gradient(90deg, #d1fae5 0%, #a7f3d0 100%) !important; 
            border-left: 6px solid #10b981; 
        } 
        
        .low-pv-warning {
            background: linear-gradient(90deg, #fed7aa 0%, #fdba74 100%) !important;
            border-left: 6px solid #f97316;
        }
        
        .inactive-warning {
            background: linear-gradient(90deg, #fecaca 0%, #fca5a5 100%) !important;
            border-left: 6px solid #ef4444;
        }
        
        .no-consistency { 
            background: linear-gradient(90deg, #fee2e2 0%, #fecaca 100%) !important; 
            border-left: 6px solid #dc2626; 
        } 
        
        .no-meeting {
            background: linear-gradient(90deg, #ddd6fe 0%, #c4b5fd 100%) !important;
            border-left: 6px solid #8b5cf6;
        }
        
        .low-group-pv {
            background: linear-gradient(90deg, #fef3c7 0%, #fde68a 100%) !important;
            border-left: 6px solid #f59e0b;
        }

        .action-bar { 
            display: flex; justify-content: space-between; gap: 15px; 
            margin-bottom: 20px; flex-wrap: wrap; 
        }
        
        #searchInput { 
            flex-grow: 1; border: 2px solid #cbd5e0; border-radius: 10px; 
            padding: 12px 15px; font-size: 14px;
        }
        
        .btn-group { display: flex; gap: 10px; flex-wrap: wrap; }
        
        .btn-success { 
            background: linear-gradient(135deg, #10b981 0%, #059669 100%); 
            color: white; border: none; padding: 12px 20px; border-radius: 8px; 
            font-weight: 700; cursor: pointer; 
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        
        .btn-danger { 
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); 
            color: white; border: none; padding: 12px 20px; border-radius: 8px; 
            font-weight: 700; cursor: pointer; 
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }
        
        .btn-trash {
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
            color: white; border: none; padding: 12px 20px; border-radius: 8px;
            font-weight: 700; cursor: pointer;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }
        
        .btn-settings {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white; border: none; padding: 12px 20px; border-radius: 8px;
            font-weight: 700; cursor: pointer;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }
        
        table { 
            width: 100%; border-collapse: collapse; background: white; 
            margin-top: 15px; border-radius: 10px; overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        th { 
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%); 
            padding: 15px; text-align: left; font-size: 11px; font-weight: 800; 
            color: white; text-transform: uppercase; letter-spacing: 0.5px;
        }
        
        td { 
            padding: 15px 12px; border-bottom: 1px solid #f1f5f9; 
            font-size: 13px;
        }
        
        tr:hover td { background-color: #f8fafc; }
        
        .wa-link { 
            color: white; text-decoration: none; font-weight: 700; 
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            padding: 6px 12px; border-radius: 6px; font-size: 11px;
            box-shadow: 0 3px 10px rgba(37, 211, 102, 0.3);
            display: inline-block;
        }
        
        .delete-btn { 
            color: #ef4444; cursor: pointer; border: none; background: none; 
            font-size: 20px;
        }
        
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 3000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.4s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-header {
            font-size: 24px;
            font-weight: 800;
            color: #1e293b;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .modal-body {
            font-size: 16px;
            line-height: 1.8;
            color: #334155;
            margin-bottom: 25px;
        }
        
        .modal-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            font-size: 15px;
            margin: 5px;
        }
        
        .modal-btn-close {
            background: #64748b;
        }
        
        .branding-bar { 
            display: flex; justify-content: space-between; align-items: center; 
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); 
            padding: 15px; border-radius: 15px; margin-top: 40px; 
            border: 2px solid #ec4899;
        }
        
        .leader-card-inline { display: flex; align-items: center; gap: 12px; }
        .profile-circle-small { 
            width: 70px; height: 70px; border-radius: 50%; 
            border: 3px solid #ec4899; overflow: hidden; background: #fff; 
        }
        .profile-circle-small img { width: 100%; height: 100%; object-fit: cover; }
        .leader-name-small { font-weight: 800; font-size: 16px; margin: 0; color: #1e293b; }
        .leader-rank-small { font-size: 9px; color: #be185d; font-weight: 800; text-transform: uppercase; }
        .team-tag { 
            font-size: 10px; color: #1e293b; font-weight: 700; 
            background: #fce7f3; padding: 3px 8px; border-radius: 6px; 
            display: inline-block; margin-top: 3px;
        }
        .inline-logo { width: 75px; height: auto; border-radius: 50%; }
    </style>
</head>
<body>

<div id="loginOverlay">
    <div class="login-box">
        <img src="https://i.postimg.cc/9rn4BN6W/NFVT-Logo.jpg" style="width: 90px; margin-bottom: 20px; border-radius: 12px;">
        <h2 style="margin: 0 0 20px 0; font-size: 20px; color: #1e293b;">Team Followup Login</h2>
        <input type="number" id="loginId" placeholder="Distributor ID" style="margin-bottom: 12px;">
        <input type="text" id="loginName" placeholder="Your Name" style="margin-top: 0;">
        <button onclick="checkLogin()" style="background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; margin-top: 20px; width: 100%; font-weight: 700;">Login</button>
    </div>
</div>

<div class="container" id="mainApp">
    <div class="user-profile-bar">
        <div class="user-details">
            <div class="user-avatar" id="userInitial">U</div>
            <div>
                <div style="font-size: 16px; font-weight: 800;" id="displayUserName">User Name</div>
                <div style="font-size: 12px; opacity: 0.9;" id="displayUserId">ID: 00000000</div>
            </div>
        </div>
        <div>
            <button class="language-toggle" onclick="toggleLanguage()">
                <span id="langBtn">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</span>
            </button>
            <button onclick="location.reload()" style="background: rgba(255,255,255,0.2); border: 2px solid white; color: white; padding: 8px 16px; border-radius: 8px; font-size: 12px; cursor: pointer; font-weight: 700;">
                <span class="lang-text" data-en="Logout" data-ta="‡Æµ‡ØÜ‡Æ≥‡Æø‡ÆØ‡Øá‡Æ±‡ØÅ">Logout</span>
            </button>
        </div>
    </div>

    <div class="stats-summary" id="totalStats">
        <span class="lang-text" data-en="Total Team PV: 0 | Members: 0 | Alerts: 0" data-ta="‡ÆÆ‡Øä‡Æ§‡Øç‡Æ§ ‡Æï‡ØÅ‡Æ¥‡ØÅ PV: 0 | ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øç: 0 | ‡Æé‡Æö‡Øç‡Æö‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Øà‡Æï‡Æ≥‡Øç: 0">Total Team PV: 0 | Members: 0 | Alerts: 0</span>
    </div>

    <div class="header-section">
        <img src="https://i.postimg.cc/9rn4BN6W/NFVT-Logo.jpg" alt="NFVT Logo" class="team-logo">
        <h1 class="luxury-gold-title">NFVT Team Followup</h1>
    </div>

    <div class="form-section">
        <div class="grid-form">
            <div class="input-group">
                <label class="lang-text" data-en="Member Name" data-ta="‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç">Member Name</label>
                <input type="text" id="downlineName">
            </div>
            <div class="input-group">
                <label class="lang-text" data-en="Mobile Number" data-ta="‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç ‡Æé‡Æ£‡Øç">Mobile Number</label>
                <input type="number" id="mobileNo">
            </div>
            <div class="input-group">
                <label class="lang-text" data-en="Distributor ID" data-ta="‡Æµ‡Æø‡Æ®‡Æø‡ÆØ‡Øã‡Æï‡Æ∏‡Øç‡Æ§‡Æ∞‡Øç ID">Distributor ID</label>
                <input type="number" id="distId">
            </div>
            <div class="input-group">
                <label class="lang-text" data-en="Level" data-ta="‡Æ®‡Æø‡Æ≤‡Øà">Level</label>
                <select id="memberLevel">
                    <option value="Distributor">Distributor</option>
                    <option value="Senior Distributor">Senior Distributor</option>
                    <option value="Assistant Bronze Director">Assistant Bronze Director</option>
                    <option value="Bronze Director">Bronze Director</option>
                    <option value="Silver Director">Silver Director</option>
                    <option value="Gold Director">Gold Director</option>
                    <option value="Star Director">Star Director</option>
                    <option value="Diamond Director">Diamond Director</option>
                    <option value="Crown Director">Crown Director</option>
                    <option value="UCD">UCD</option>
                </select>
            </div>
            <div class="input-group">
                <label class="lang-text" data-en="Self PV" data-ta="‡Æö‡Øä‡Æ®‡Øç‡Æ§ PV">Self PV</label>
                <input type="number" id="selfPV">
            </div>
            <div class="input-group">
                <label class="lang-text" data-en="Group PV" data-ta="‡Æï‡ØÅ‡Æ¥‡ØÅ PV">Group PV</label>
                <input type="number" id="groupPV">
            </div>
            <div class="input-group">
                <label class="lang-text" data-en="Date" data-ta="‡Æ§‡Øá‡Æ§‡Æø">Date</label>
                <input type="date" id="followUpDate">
            </div>
            <div class="input-group">
                <label class="lang-text" data-en="100PV CNC" data-ta="100PV ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø">100PV CNC</label>
                <select id="consistency">
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="input-group">
                <label class="lang-text" data-en="Meeting" data-ta="‡Æï‡ØÇ‡Æü‡Øç‡Æü‡ÆÆ‡Øç">Meeting</label>
                <select id="meeting">
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <button class="add-btn" onclick="addData()">
                <span class="lang-text" data-en="‚ûï Add Member" data-ta="‚ûï ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øà ‡Æö‡Øá‡Æ∞‡Øç">‚ûï Add Member</span>
            </button>
        </div>
    </div>

    <div class="action-bar">
        <input type="text" id="searchInput" onkeyup="filterTable()" placeholder="üîç Search...">
        <div class="btn-group">
            <button class="btn-success" onclick="downloadCSV()">
                <span class="lang-text" data-en="üìä Excel" data-ta="üìä ‡Æé‡Æï‡Øç‡Æö‡ØÜ‡Æ≤‡Øç">üìä Excel</span>
            </button>
            <button class="btn-danger" onclick="downloadPDF()">
                <span class="lang-text" data-en="üìÑ PDF" data-ta="üìÑ PDF">üìÑ PDF</span>
            </button>
            <button class="btn-settings" onclick="showReports()">
                <span class="lang-text" data-en="üìà Reports" data-ta="üìà ‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà‡Æï‡Æ≥‡Øç">üìà Reports</span>
            </button>
            <button class="btn-trash" onclick="toggleTrash()">
                <span class="lang-text" data-en="üóëÔ∏è Trash" data-ta="üóëÔ∏è ‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Øà">üóëÔ∏è Trash</span>
            </button>
        </div>
    </div>

    <div style="overflow-x: auto;">
        <table>
            <thead>
                <tr>
                    <th class="lang-text" data-en="Member & ID" data-ta="‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç & ID">Member & ID</th>
                    <th class="lang-text" data-en="Mobile" data-ta="‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç">Mobile</th>
                    <th class="lang-text" data-en="Level" data-ta="‡Æ®‡Æø‡Æ≤‡Øà">Level</th>
                    <th class="lang-text" data-en="Self PV" data-ta="‡Æö‡Øä‡Æ®‡Øç‡Æ§ PV">Self PV</th>
                    <th class="lang-text" data-en="Group PV" data-ta="‡Æï‡ØÅ‡Æ¥‡ØÅ PV">Group PV</th>
                    <th class="lang-text" data-en="Total PV" data-ta="‡ÆÆ‡Øä‡Æ§‡Øç‡Æ§ PV">Total PV</th>
                    <th class="lang-text" data-en="Date" data-ta="‡Æ§‡Øá‡Æ§‡Æø">Date</th>
                    <th class="lang-text" data-en="100PV" data-ta="100PV">100PV</th>
                    <th class="lang-text" data-en="Meeting" data-ta="‡Æï‡ØÇ‡Æü‡Øç‡Æü‡ÆÆ‡Øç">Meeting</th>
                    <th class="lang-text" data-en="Status" data-ta="‡Æ®‡Æø‡Æ≤‡Øà">Status</th>
                    <th class="lang-text" data-en="Actions" data-ta="‡Æö‡ØÜ‡ÆØ‡Æ≤‡Øç‡Æï‡Æ≥‡Øç">Actions</th>
                    <th>WA</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>

    <div id="editModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <span class="lang-text" data-en="‚úèÔ∏è Edit Member Details" data-ta="‚úèÔ∏è ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç ‡Æµ‡Æø‡Æµ‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡Æ§‡Æø‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ">‚úèÔ∏è Edit Member Details</span>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editId">
                <div class="grid-form">
                    <div class="input-group">
                        <label class="lang-text" data-en="Member Name" data-ta="‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç">Member Name</label>
                        <input type="text" id="editName">
                    </div>
                    <div class="input-group">
                        <label class="lang-text" data-en="Mobile Number" data-ta="‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç ‡Æé‡Æ£‡Øç">Mobile Number</label>
                        <input type="number" id="editMobile">
                    </div>
                    <div class="input-group">
                        <label class="lang-text" data-en="Self PV" data-ta="‡Æö‡Øä‡Æ®‡Øç‡Æ§ PV">Self PV</label>
                        <input type="number" id="editSelfPV">
                    </div>
                    <div class="input-group">
                        <label class="lang-text" data-en="Group PV" data-ta="‡Æï‡ØÅ‡Æ¥‡ØÅ PV">Group PV</label>
                        <input type="number" id="editGroupPV">
                    </div>
                    <div class="input-group">
                        <label class="lang-text" data-en="Date" data-ta="‡Æ§‡Øá‡Æ§‡Æø">Date</label>
                        <input type="date" id="editDate">
                    </div>
                    <div class="input-group">
                        <label class="lang-text" data-en="100PV CNC" data-ta="100PV ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø">100PV CNC</label>
                        <select id="editConsistency">
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="lang-text" data-en="Meeting" data-ta="‡Æï‡ØÇ‡Æü‡Øç‡Æü‡ÆÆ‡Øç">Meeting</label>
                        <select id="editMeeting">
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                        </select>
                    </div>
                </div>
            </div>
            <div style="text-align: center;">
                <button class="modal-btn" onclick="saveEdit()">
                    <span class="lang-text" data-en="üíæ Save Changes" data-ta="üíæ ‡ÆÆ‡Ææ‡Æ±‡Øç‡Æ±‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡Æö‡Øá‡ÆÆ‡Æø">üíæ Save Changes</span>
                </button>
                <button class="modal-btn modal-btn-close" onclick="closeEditModal()">
                    <span class="lang-text" data-en="Close" data-ta="‡ÆÆ‡ØÇ‡Æü‡ØÅ">Close</span>
                </button>
            </div>
        </div>
    </div>

    <div id="reportsModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <span class="lang-text" data-en="üìä Reports & Analytics" data-ta="üìä ‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà‡Æï‡Æ≥‡Øç & ‡Æ™‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡ØÅ">üìä Reports & Analytics</span>
            </div>
            <div class="modal-body" id="reportsContent">
                <!-- Dynamic content will be inserted here -->
            </div>
            <div style="text-align: center;">
                <button class="modal-btn" onclick="downloadMonthlyReport()">
                    <span class="lang-text" data-en="üìÑ Download Monthly Report" data-ta="üìÑ ‡ÆÆ‡Ææ‡Æ§‡Ææ‡Æ®‡Øç‡Æ§‡Æø‡Æ∞ ‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà‡ÆØ‡Øà ‡Æ™‡Æ§‡Æø‡Æµ‡Æø‡Æ±‡Æï‡Øç‡Æï‡ØÅ">üìÑ Download Monthly Report</span>
                </button>
                <button class="modal-btn modal-btn-close" onclick="closeReportsModal()">
                    <span class="lang-text" data-en="Close" data-ta="‡ÆÆ‡ØÇ‡Æü‡ØÅ">Close</span>
                </button>
            </div>
        </div>
    </div>

    <div id="trashSection" style="display: none; background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%); padding: 20px; border-radius: 15px; margin: 25px 0; border: 3px dashed #f87171;">
        <h3 style="font-size: 16px; margin: 0 0 15px 0; color: #dc2626; font-weight: 800;">
            <span class="lang-text" data-en="‚ôªÔ∏è Deleted Members" data-ta="‚ôªÔ∏è ‡Æ®‡ØÄ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øç">‚ôªÔ∏è Deleted Members</span>
        </h3>
        <table style="background: transparent;"><tbody id="trashBody"></tbody></table>
        <button onclick="toggleTrash()" style="font-size: 12px; cursor: pointer; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 6px; margin-top: 10px; font-weight: 700;">
            <span class="lang-text" data-en="Close Trash" data-ta="‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Øà‡ÆØ‡Øà ‡ÆÆ‡ØÇ‡Æü‡ØÅ">Close Trash</span>
        </button>
        <button onclick="emptyTrash()" style="font-size: 12px; cursor: pointer; padding: 8px 16px; background: #7f1d1d; color: white; border: none; border-radius: 6px; margin-top: 10px; margin-left: 10px; font-weight: 700;">
            <span class="lang-text" data-en="üóëÔ∏è Empty Trash" data-ta="üóëÔ∏è ‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Øà‡ÆØ‡Øà ‡Æï‡Ææ‡Æ≤‡Æø ‡Æö‡ØÜ‡ÆØ‡Øç">üóëÔ∏è Empty Trash</span>
        </button>
    </div>

    <div class="branding-bar">
        <div class="leader-card-inline">
            <div class="profile-circle-small"><img src="https://i.postimg.cc/XvTq85tC/Girish-S.jpg"></div>
            <div>
                <p class="leader-name-small">Girish S</p>
                <span class="leader-rank-small">Universal Crown Director of Vestige</span>
                <span class="team-tag">DUCD Saravanan Team</span>
            </div>
        </div>
        <img src="https://i.postimg.cc/PNWQDG2x/New-Logo.jpg" alt="Team Branding" class="inline-logo">
    </div>
</div>

<script>
    let currentLanguage = 'en';
    let loggedInUser = {};
    let dailyTargetPercentage = 8;

    // Check for 100PV consistency reminder (2nd to 14th of month)
    function check100PVReminder() {
        const today = new Date();
        const dayOfMonth = today.getDate();
        
        // Check if between 2nd and 14th
        if (dayOfMonth >= 2 && dayOfMonth <= 14) {
            const entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
            const below100PV = entries.filter(e => e.selfPV < 100);
            
            if (below100PV.length > 0) {
                const lastReminder = localStorage.getItem('last100PVReminder');
                const todayStr = today.toDateString();
                
                // Show reminder once per day
                if (lastReminder !== todayStr) {
                    show100PVReminderPopup(below100PV, dayOfMonth);
                    localStorage.setItem('last100PVReminder', todayStr);
                }
            }
        }
    }

    function show100PVReminderPopup(members, currentDay) {
        const daysLeft = 14 - currentDay;
        const message = currentLanguage === 'en'
            ? `‚è∞ 100PV CONSISTENCY REMINDER!\n\n${members.length} members have not completed 100 PV yet.\n\n‚ö†Ô∏è ${daysLeft} days left! Complete before 14th of this month.\n\nüéÅ DON'T MISS: Consistency Product Voucher worth ‚Çπ2500!\n\nWould you like to send WhatsApp reminders?`
            : `‚è∞ 100PV ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡Æ®‡Æø‡Æ©‡Øà‡Æµ‡ØÇ‡Æü‡Øç‡Æü‡Æ≤‡Øç!\n\n${members.length} ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øç ‡Æá‡Æ©‡Øç‡Æ©‡ØÅ‡ÆÆ‡Øç 100 PV ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æï‡Øç‡Æï‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà.\n\n‚ö†Ô∏è ${daysLeft} ‡Æ®‡Ææ‡Æü‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æü‡Øç‡Æü‡ØÅ‡ÆÆ‡Øá! ‡Æá‡Æ®‡Øç‡Æ§ ‡ÆÆ‡Ææ‡Æ§‡ÆÆ‡Øç 14‡Æï‡Øç‡Æï‡ØÅ‡Æ≥‡Øç ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.\n\nüéÅ ‡Æ§‡Æµ‡Æ±‡Æµ‡Æø‡Æü‡Ææ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç: ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡Æ§‡ÆØ‡Ææ‡Æ∞‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æµ‡Æµ‡ØÅ‡Æö‡Øç‡Æö‡Æ∞‡Øç ‚Çπ2500 ‡ÆÆ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡ØÅ!\n\nWhatsApp ‡Æ®‡Æø‡Æ©‡Øà‡Æµ‡ØÇ‡Æü‡Øç‡Æü‡Æ≤‡Øç‡Æï‡Æ≥‡Øà ‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Øç‡Æ™ ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡Æï‡Æø‡Æ±‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Ææ?`;
        
        if (confirm(message)) {
            send100PVReminders(members, daysLeft);
        }
    }

    function send100PVReminders(members, daysLeft) {
        members.forEach((member, index) => {
            const needed = 100 - member.selfPV;
            const waMessage = currentLanguage === 'en'
                ? `Hello ${member.name}! üëã\n\n‚è∞ *100PV CONSISTENCY REMINDER*\n\nüìÖ Deadline: Before 14th of this month (${daysLeft} days left)\nüìä Your Current Self PV: ${member.selfPV}\nüéØ Target: 100 PV\n‚ö†Ô∏è Remaining: *${needed} PV*\n\nüéÅ *SPECIAL BENEFIT:*\nComplete 100 PV consistency and get Product Voucher worth *‚Çπ2500*!\n\nüí° Don't miss this opportunity!\n\nüí™ Complete your ${needed} PV before 14th!\n\nüåü Team NFVT - Success is yours!`
                : `‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç ${member.name}! üëã\n\n‚è∞ *100PV ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡Æ®‡Æø‡Æ©‡Øà‡Æµ‡ØÇ‡Æü‡Øç‡Æü‡Æ≤‡Øç*\n\nüìÖ ‡Æï‡Æü‡Øà‡Æö‡Æø ‡Æ®‡Ææ‡Æ≥‡Øç: ‡Æá‡Æ®‡Øç‡Æ§ ‡ÆÆ‡Ææ‡Æ§‡ÆÆ‡Øç 14‡Æï‡Øç‡Æï‡ØÅ‡Æ≥‡Øç (${daysLeft} ‡Æ®‡Ææ‡Æü‡Øç‡Æï‡Æ≥‡Øç ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æ©)\nüìä ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ§‡Æ±‡Øç‡Æ™‡Øã‡Æ§‡Øà‡ÆØ ‡Æö‡Øä‡Æ®‡Øç‡Æ§ PV: ${member.selfPV}\nüéØ ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ: 100 PV\n‚ö†Ô∏è ‡ÆÆ‡ØÄ‡Æ§‡ÆÆ‡Øç: *${needed} PV*\n\nüéÅ *‡Æö‡Æø‡Æ±‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ™‡Æ≤‡Æ©‡Øç:*\n100 PV ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø‡ÆØ‡Øà ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æ§‡Øç‡Æ§‡ØÅ *‚Çπ2500* ‡ÆÆ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æ≥‡Øç‡Æ≥ ‡Æ§‡ÆØ‡Ææ‡Æ∞‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æµ‡Æµ‡ØÅ‡Æö‡Øç‡Æö‡Æ∞‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç!\n\nüí° ‡Æá‡Æ®‡Øç‡Æ§ ‡Æµ‡Ææ‡ÆØ‡Øç‡Æ™‡Øç‡Æ™‡Øà ‡Æ§‡Æµ‡Æ±‡Æµ‡Æø‡Æü‡Ææ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç!\n\nüí™ ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ${needed} PV ‡Æê 14‡Æï‡Øç‡Æï‡ØÅ‡Æ≥‡Øç ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç!\n\nüåü Team NFVT - ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æü‡Øà‡ÆØ‡Æ§‡ØÅ!`;
            
            setTimeout(() => {
                window.open(`https://wa.me/91${member.mobile}?text=${encodeURIComponent(waMessage)}`, '_blank');
            }, index * 2000);
        });
    }

    // Check for low Group PV (below 2600)
    function checkLowGroupPV() {
        const entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
        const lowGroupPV = entries.filter(e => e.groupPV < 2600);
        
        if (lowGroupPV.length > 0) {
            const lastReminder = localStorage.getItem('lastLowGroupPVReminder');
            const today = new Date().toDateString();
            
            if (lastReminder !== today) {
                showLowGroupPVPopup(lowGroupPV);
                localStorage.setItem('lastLowGroupPVReminder', today);
            }
        }
    }

    function showLowGroupPVPopup(members) {
        const message = currentLanguage === 'en'
            ? `‚ö†Ô∏è LOW GROUP PV ALERT!\n\n${members.length} members have Group PV below 2600.\n\nThey need to improve their team building!\n\nWould you like to send WhatsApp reminders?`
            : `‚ö†Ô∏è ‡Æï‡ØÅ‡Æ±‡Øà‡Æ®‡Øç‡Æ§ ‡Æï‡ØÅ‡Æ¥‡ØÅ PV ‡Æé‡Æö‡Øç‡Æö‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Øà!\n\n${members.length} ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ 2600‡Æï‡Øç‡Æï‡ØÅ ‡Æï‡ØÄ‡Æ¥‡Øç ‡Æï‡ØÅ‡Æ¥‡ØÅ PV ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æ§‡ØÅ.\n\n‡ÆÖ‡Æµ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç ‡Æ§‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡ØÅ‡Æ¥‡ØÅ ‡Æï‡Æü‡Øç‡Æü‡ÆÆ‡Øà‡Æ™‡Øç‡Æ™‡Øà ‡ÆÆ‡Øá‡ÆÆ‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§ ‡Æµ‡Øá‡Æ£‡Øç‡Æü‡ØÅ‡ÆÆ‡Øç!\n\nWhatsApp ‡Æ®‡Æø‡Æ©‡Øà‡Æµ‡ØÇ‡Æü‡Øç‡Æü‡Æ≤‡Øç‡Æï‡Æ≥‡Øà ‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Øç‡Æ™ ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡Æï‡Æø‡Æ±‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Ææ?`;
        
        if (confirm(message)) {
            sendLowGroupPVReminders(members);
        }
    }

    function sendLowGroupPVReminders(members) {
        members.forEach((member, index) => {
            const needed = 2600 - member.groupPV;
            const waMessage = currentLanguage === 'en'
                ? `Hello ${member.name}! üëã\n\n‚ö†Ô∏è *GROUP PV IMPROVEMENT NEEDED*\n\nüìä Your Current Group PV: ${member.groupPV}\nüéØ Target: 2600 PV\nüìà Need to Improve: *${needed} PV*\n\nüí° *Action Required:*\n- Focus on team building\n- Help your downlines achieve their targets\n- Conduct more team meetings\n- Support your team members\n\nüí™ Build your team stronger!\n\nüåü Team NFVT - Together we grow!`
                : `‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç ${member.name}! üëã\n\n‚ö†Ô∏è *‡Æï‡ØÅ‡Æ¥‡ØÅ PV ‡ÆÆ‡Øá‡ÆÆ‡Øç‡Æ™‡Ææ‡Æü‡ØÅ ‡Æ§‡Øá‡Æµ‡Øà*\n\nüìä ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ§‡Æ±‡Øç‡Æ™‡Øã‡Æ§‡Øà‡ÆØ ‡Æï‡ØÅ‡Æ¥‡ØÅ PV: ${member.groupPV}\nüéØ ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ: 2600 PV\nüìà ‡ÆÆ‡Øá‡ÆÆ‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§ ‡Æµ‡Øá‡Æ£‡Øç‡Æü‡Æø‡ÆØ‡Æ§‡ØÅ: *${needed} PV*\n\nüí° *‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ ‡Æµ‡Øá‡Æ£‡Øç‡Æü‡Æø‡ÆØ‡Æµ‡Øà:*\n- ‡Æï‡ØÅ‡Æ¥‡ØÅ ‡Æï‡Æü‡Øç‡Æü‡ÆÆ‡Øà‡Æ™‡Øç‡Æ™‡Æø‡Æ≤‡Øç ‡Æï‡Æµ‡Æ©‡ÆÆ‡Øç ‡Æö‡ØÜ‡Æ≤‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç\n- ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡ØÄ‡Æ¥‡Øç‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Æø‡Æ©‡Æ∞‡Øà ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡Øà ‡ÆÖ‡Æü‡Øà‡ÆØ ‡Æâ‡Æ§‡Æµ‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç\n- ‡ÆÖ‡Æ§‡Æø‡Æï ‡Æï‡ØÅ‡Æ¥‡ØÅ ‡Æï‡ØÇ‡Æü‡Øç‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡Æ®‡Æü‡Æ§‡Øç‡Æ§‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç\n- ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡ØÅ‡Æ¥‡ØÅ ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡ÆÜ‡Æ§‡Æ∞‡Æµ‡Æ≥‡Æø‡ÆØ‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç\n\nüí™ ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡ØÅ‡Æ¥‡ØÅ‡Æµ‡Øà ‡Æµ‡Æ≤‡ØÅ‡Æµ‡Ææ‡Æï ‡Æâ‡Æ∞‡ØÅ‡Æµ‡Ææ‡Æï‡Øç‡Æï‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç!\n\nüåü Team NFVT - ‡Æí‡Æ©‡Øç‡Æ±‡Ææ‡Æï ‡Æµ‡Æ≥‡Æ∞‡ØÅ‡Æµ‡Øã‡ÆÆ‡Øç!`;
            
            setTimeout(() => {
                window.open(`https://wa.me/91${member.mobile}?text=${encodeURIComponent(waMessage)}`, '_blank');
            }, index * 2000);
        });
    }

    // Check for inactive IDs (Self PV below 30) - send reminder before month end
    function checkInactiveIDs() {
        const today = new Date();
        const dayOfMonth = today.getDate();
        const lastDayOfMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
        
        // Check from 25th onwards (last week of month)
        if (dayOfMonth >= 25) {
            const entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
            const inactiveIDs = entries.filter(e => e.selfPV < 30);
            
            if (inactiveIDs.length > 0) {
                const lastReminder = localStorage.getItem('lastInactiveIDReminder');
                const todayStr = today.toDateString();
                
                if (lastReminder !== todayStr) {
                    showInactiveIDPopup(inactiveIDs, lastDayOfMonth - dayOfMonth);
                    localStorage.setItem('lastInactiveIDReminder', todayStr);
                }
            }
        }
    }

    function showInactiveIDPopup(members, daysLeft) {
        const message = currentLanguage === 'en'
            ? `üö® URGENT: INACTIVE ID ALERT!\n\n${members.length} members have Self PV below 30.\n\n‚ö†Ô∏è Their IDs will become INACTIVE!\n‚ö†Ô∏è They will lose team support benefits!\n\n${daysLeft} days left before month end!\n\nWould you like to send WhatsApp reminders?`
            : `üö® ‡ÆÖ‡Æµ‡Æö‡Æ∞‡ÆÆ‡Øç: ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Æ±‡Øç‡Æ± ID ‡Æé‡Æö‡Øç‡Æö‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Øà!\n\n${members.length} ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ 30‡Æï‡Øç‡Æï‡ØÅ ‡Æï‡ØÄ‡Æ¥‡Øç ‡Æö‡Øä‡Æ®‡Øç‡Æ§ PV ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æ§‡ØÅ.\n\n‚ö†Ô∏è ‡ÆÖ‡Æµ‡Æ∞‡Øç‡Æï‡Æ≥‡Æø‡Æ©‡Øç ID ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Æ±‡Øç‡Æ±‡Æ§‡Ææ‡Æï‡Æø‡Æµ‡Æø‡Æü‡ØÅ‡ÆÆ‡Øç!\n‚ö†Ô∏è ‡ÆÖ‡Æµ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡ØÅ‡Æ¥‡ØÅ ‡ÆÜ‡Æ§‡Æ∞‡Æµ‡ØÅ ‡Æ™‡Æ≤‡Æ©‡Øç‡Æï‡Æ≥‡Øà ‡Æá‡Æ¥‡Æ™‡Øç‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç!\n\n‡ÆÆ‡Ææ‡Æ§‡ÆÆ‡Øç ‡ÆÆ‡ØÅ‡Æü‡Æø‡ÆØ ${daysLeft} ‡Æ®‡Ææ‡Æü‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æü‡Øç‡Æü‡ØÅ‡ÆÆ‡Øá!\n\nWhatsApp ‡Æ®‡Æø‡Æ©‡Øà‡Æµ‡ØÇ‡Æü‡Øç‡Æü‡Æ≤‡Øç‡Æï‡Æ≥‡Øà ‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Øç‡Æ™ ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡Æï‡Æø‡Æ±‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Ææ?`;
        
        if (confirm(message)) {
            sendInactiveIDReminders(members, daysLeft);
        }
    }

    function sendInactiveIDReminders(members, daysLeft) {
        members.forEach((member, index) => {
            const needed = 30 - member.selfPV;
            const waMessage = currentLanguage === 'en'
                ? `Hello ${member.name}! üëã\n\nüö® *URGENT - ID ACTIVATION ALERT*\n\n‚ö†Ô∏è Your ID will become INACTIVE!\n\nüìä Your Current Self PV: ${member.selfPV}\nüéØ Minimum Required: 30 PV\n‚ö†Ô∏è Need Immediately: *${needed} PV*\n\n‚ùå *What you will LOSE if ID becomes inactive:*\n- Team support benefits\n- Monthly bonuses\n- Team commission\n- Growth opportunities\n- All team privileges\n\n‚è∞ *URGENT ACTION REQUIRED:*\nComplete *${needed} PV* before this month end!\n\nOnly *${daysLeft} days* left!\n\nüìû Contact your upline NOW for support!\n\nüí™ Don't lose your hard work!\n\nüåü Team NFVT - We support you!`
                : `‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç ${member.name}! üëã\n\nüö® *‡ÆÖ‡Æµ‡Æö‡Æ∞‡ÆÆ‡Øç - ID ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æ≤‡Øç ‡Æé‡Æö‡Øç‡Æö‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Øà*\n\n‚ö†Ô∏è ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ID ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Æ±‡Øç‡Æ±‡Æ§‡Ææ‡Æï‡Æø‡Æµ‡Æø‡Æü‡ØÅ‡ÆÆ‡Øç!\n\nüìä ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ§‡Æ±‡Øç‡Æ™‡Øã‡Æ§‡Øà‡ÆØ ‡Æö‡Øä‡Æ®‡Øç‡Æ§ PV: ${member.selfPV}\nüéØ ‡Æï‡ØÅ‡Æ±‡Øà‡Æ®‡Øç‡Æ§‡Æ™‡Æü‡Øç‡Æö‡ÆÆ‡Øç ‡Æ§‡Øá‡Æµ‡Øà: 30 PV\n‚ö†Ô∏è ‡Æâ‡Æü‡Æ©‡Æü‡Æø‡ÆØ‡Ææ‡Æï ‡Æ§‡Øá‡Æµ‡Øà: *${needed} PV*\n\n‚ùå *ID ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Æ±‡Øç‡Æ±‡Æ§‡Ææ‡Æ©‡Ææ‡Æ≤‡Øç ‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æá‡Æ¥‡Æ™‡Øç‡Æ™‡Æµ‡Øà:*\n- ‡Æï‡ØÅ‡Æ¥‡ØÅ ‡ÆÜ‡Æ§‡Æ∞‡Æµ‡ØÅ ‡Æ™‡Æ≤‡Æ©‡Øç‡Æï‡Æ≥‡Øç\n- ‡ÆÆ‡Ææ‡Æ§‡Ææ‡Æ®‡Øç‡Æ§‡Æø‡Æ∞ ‡Æ™‡Øã‡Æ©‡Æ∏‡Øç\n- ‡Æï‡ØÅ‡Æ¥‡ØÅ ‡Æï‡ÆÆ‡Æø‡Æ∑‡Æ©‡Øç\n- ‡Æµ‡Æ≥‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡Æµ‡Ææ‡ÆØ‡Øç‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç\n- ‡ÆÖ‡Æ©‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æï‡ØÅ‡Æ¥‡ØÅ ‡Æö‡Æ≤‡ØÅ‡Æï‡Øà‡Æï‡Æ≥‡ØÅ‡ÆÆ‡Øç\n\n‚è∞ *‡ÆÖ‡Æµ‡Æö‡Æ∞ ‡Æ®‡Æü‡Æµ‡Æü‡Æø‡Æï‡Øç‡Æï‡Øà:*\n‡Æá‡Æ®‡Øç‡Æ§ ‡ÆÆ‡Ææ‡Æ§‡ÆÆ‡Øç ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡Æ§‡Æ±‡Øç‡Æï‡ØÅ‡Æ≥‡Øç *${needed} PV* ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç!\n\n‡Æµ‡ØÜ‡Æ±‡ØÅ‡ÆÆ‡Øç *${daysLeft} ‡Æ®‡Ææ‡Æü‡Øç‡Æï‡Æ≥‡Øç* ‡ÆÆ‡Æü‡Øç‡Æü‡ØÅ‡ÆÆ‡Øá ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æ©!\n\nüìû ‡Æâ‡Æü‡Æ©‡Æü‡Æø‡ÆØ‡Ææ‡Æï ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç upline ‡Æê ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æ™‡ØÅ ‡Æï‡Øä‡Æ≥‡Øç‡Æ≥‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç!\n\nüí™ ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡Æü‡Æø‡Æ© ‡Æâ‡Æ¥‡Øà‡Æ™‡Øç‡Æ™‡Øà ‡Æá‡Æ¥‡Æï‡Øç‡Æï‡Ææ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç!\n\nüåü Team NFVT - ‡Æ®‡Ææ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡ÆÜ‡Æ§‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Æø‡Æ±‡Øã‡ÆÆ‡Øç!`;
            
            setTimeout(() => {
                window.open(`https://wa.me/91${member.mobile}?text=${encodeURIComponent(waMessage)}`, '_blank');
            }, index * 2000);
        });
    }

    // Check for meeting reminders
    function checkMeetingTime() {
        const now = new Date();
        const hours = now.getHours();
        const minutes = now.getMinutes();
        
        // Check for 6 PM (17:50) and 8 PM (19:50) - 10 minutes before
        if ((hours === 17 && minutes === 50) || (hours === 19 && minutes === 50)) {
            const meetingTime = hours === 17 ? "6:00 PM" : "8:00 PM";
            const entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
            const today = new Date().toISOString().split('T')[0];
            
            const lastReminder = localStorage.getItem('lastMeetingReminder');
            if (lastReminder !== today + '-' + meetingTime) {
                const nonAttendees = entries.filter(e => e.meeting === 'No');
                
                if (nonAttendees.length > 0) {
                    showMeetingReminder(meetingTime, nonAttendees);
                    localStorage.setItem('lastMeetingReminder', today + '-' + meetingTime);
                }
            }
        }
    }

    function showMeetingReminder(time, members) {
        const message = currentLanguage === 'en' 
            ? `‚è∞ Meeting Alert!\n\nThe ${time} meeting is starting in 10 minutes.\n\n${members.length} members haven't attended recent meetings.\n\nConsistency is key to success!`
            : `‚è∞ ‡Æï‡ØÇ‡Æü‡Øç‡Æü‡ÆÆ‡Øç ‡Æé‡Æö‡Øç‡Æö‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Øà!\n\n${time} ‡Æï‡ØÇ‡Æü‡Øç‡Æü‡ÆÆ‡Øç 10 ‡Æ®‡Æø‡ÆÆ‡Æø‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ.\n\n${members.length} ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øç ‡Æö‡ÆÆ‡ØÄ‡Æ™‡Æ§‡Øç‡Æ§‡Æø‡ÆØ ‡Æï‡ØÇ‡Æü‡Øç‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æï‡Æ≤‡Æ®‡Øç‡Æ§‡ØÅ ‡Æï‡Øä‡Æ≥‡Øç‡Æ≥‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà.\n\n‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø‡Æï‡Øç‡Æï‡ØÅ ‡ÆÆ‡ØÅ‡Æï‡Øç‡Æï‡Æø‡ÆØ‡ÆÆ‡Øç!`;
        
        if (confirm(message + '\n\nWould you like to send WhatsApp reminders?')) {
            members.forEach((member, index) => {
                const waMessage = currentLanguage === 'en'
                    ? `Hello ${member.name}! üëã\n\n‚è∞ Meeting Reminder!\n\nOur team meeting starts at ${time} (in 10 minutes).\n\nüìç Please join the meeting to improve your business growth.\n\nüí° Consistency in attending meetings is crucial for success!\n\nüí™ See you there!`
                    : `‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç ${member.name}! üëã\n\n‚è∞ ‡Æï‡ØÇ‡Æü‡Øç‡Æü‡ÆÆ‡Øç ‡Æ®‡Æø‡Æ©‡Øà‡Æµ‡ØÇ‡Æü‡Øç‡Æü‡Æ≤‡Øç!\n\n‡Æé‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡ØÅ‡Æ¥‡ØÅ ‡Æï‡ØÇ‡Æü‡Øç‡Æü‡ÆÆ‡Øç ${time} (10 ‡Æ®‡Æø‡ÆÆ‡Æø‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç) ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ.\n\nüìç ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æø‡ÆØ‡Ææ‡Æ™‡Ææ‡Æ∞ ‡Æµ‡Æ≥‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø‡ÆØ‡Øà ‡ÆÆ‡Øá‡ÆÆ‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§ ‡Æï‡ØÇ‡Æü‡Øç‡Æü‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æö‡Øá‡Æ∞‡Æµ‡ØÅ‡ÆÆ‡Øç.\n\nüí° ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø‡Æï‡Øç‡Æï‡ØÅ ‡Æï‡ØÇ‡Æü‡Øç‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø‡ÆØ‡Ææ‡Æï ‡Æï‡Æ≤‡Æ®‡Øç‡Æ§‡ØÅ‡Æï‡Øä‡Æ≥‡Øç‡Æµ‡Æ§‡ØÅ ‡ÆÖ‡Æµ‡Æö‡Æø‡ÆØ‡ÆÆ‡Øç!\n\nüí™ ‡ÆÖ‡Æô‡Øç‡Æï‡Øá ‡Æö‡Æ®‡Øç‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡Øã‡ÆÆ‡Øç!`;
                
                setTimeout(() => {
                    window.open(`https://wa.me/91${member.mobile}?text=${encodeURIComponent(waMessage)}`, '_blank');
                }, index * 2000);
            });
        }
    }

    // Check for inactivity
    function checkInactivity() {
        const lastActive = localStorage.getItem('lastActiveDate');
        const today = new Date().toISOString().split('T')[0];
        
        if (lastActive && lastActive !== today) {
            const daysDiff = Math.floor((new Date(today) - new Date(lastActive)) / (1000 * 60 * 60 * 24));
            
            if (daysDiff >= 1) {
                const message = currentLanguage === 'en'
                    ? `‚ö†Ô∏è Consistency Alert!\n\nYou haven't updated your followup in ${daysDiff} day(s).\n\nüí° Daily consistency is very important for success!\n\nUpdate your team's progress daily to achieve your goals.`
                    : `‚ö†Ô∏è ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡Æé‡Æö‡Øç‡Æö‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Øà!\n\n‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ${daysDiff} ‡Æ®‡Ææ‡Æ≥‡Øç‡Æï‡Æ≥‡Ææ‡Æï ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Æø‡Æ©‡Øç‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æ§‡Æ≤‡Øà ‡Æ™‡ØÅ‡Æ§‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æï‡Øç‡Æï‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà.\n\nüí° ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø‡Æï‡Øç‡Æï‡ØÅ ‡Æ§‡Æø‡Æ©‡Æö‡Æ∞‡Æø ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡ÆÆ‡Æø‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡ØÅ‡Æï‡Øç‡Æï‡Æø‡ÆØ‡ÆÆ‡Øç!\n\n‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ‡Æï‡Æ≥‡Øà ‡ÆÖ‡Æü‡Øà‡ÆØ ‡Æ§‡Æø‡Æ©‡Æö‡Æ∞‡Æø ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡ØÅ‡Æ¥‡ØÅ‡Æµ‡Æø‡Æ©‡Øç ‡ÆÆ‡ØÅ‡Æ©‡Øç‡Æ©‡Øá‡Æ±‡Øç‡Æ±‡Æ§‡Øç‡Æ§‡Øà ‡Æ™‡ØÅ‡Æ§‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.`;
                
                alert(message);
            }
        }
        
        localStorage.setItem('lastActiveDate', today);
    }

    function toggleLanguage() {
        currentLanguage = currentLanguage === 'en' ? 'ta' : 'en';
        document.getElementById('langBtn').textContent = currentLanguage === 'en' ? '‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç' : 'English';
        
        document.querySelectorAll('.lang-text').forEach(el => {
            el.textContent = el.getAttribute('data-' + currentLanguage);
        });
        
        displayData();
        localStorage.setItem('preferredLanguage', currentLanguage);
    }

    function checkLogin() {
        const id = document.getElementById('loginId').value;
        const name = document.getElementById('loginName').value;
        
        if(id.length >= 8 && name.trim() !== "") {
            loggedInUser = { id, name };
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            document.getElementById('displayUserName').innerText = name;
            document.getElementById('displayUserId').innerText = "ID: " + id;
            document.getElementById('userInitial').innerText = name.charAt(0).toUpperCase();
            
            const savedLang = localStorage.getItem('preferredLanguage');
            if (savedLang && savedLang !== currentLanguage) {
                toggleLanguage();
            }
            
            checkInactivity();
            displayData();
            
            // Check all reminders
            check100PVReminder();
            checkLowGroupPV();
            checkInactiveIDs();
            
            // Check meeting time every minute
            setInterval(checkMeetingTime, 60000);
            
            // Check reminders every hour
            setInterval(() => {
                check100PVReminder();
                checkLowGroupPV();
                checkInactiveIDs();
            }, 3600000);
        } else {
            alert("Please enter valid 8-digit ID and Name!");
        }
    }

    window.onload = function() { 
        document.getElementById('followUpDate').value = new Date().toISOString().split('T')[0];
    };

    function addData() {
        const name = document.getElementById('downlineName').value;
        const mobile = document.getElementById('mobileNo').value;
        const distId = document.getElementById('distId').value;
        const level = document.getElementById('memberLevel').value;
        const selfPV = parseFloat(document.getElementById('selfPV').value) || 0;
        const groupPV = parseFloat(document.getElementById('groupPV').value) || 0;
        const totalPV = selfPV + groupPV;
        const date = document.getElementById('followUpDate').value;
        const consistency = document.getElementById('consistency').value;
        const meeting = document.getElementById('meeting').value;

        if (!name || distId.length < 8 || !mobile) { 
            alert(currentLanguage === 'en' 
                ? "‚ö†Ô∏è Please fill Name, ID (8 digits), and Mobile!" 
                : "‚ö†Ô∏è ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç, ID (8 ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡Æô‡Øç‡Æï‡Æ≥‡Øç) ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç ‡Æ®‡Æø‡Æ∞‡Æ™‡Øç‡Æ™‡Æµ‡ØÅ‡ÆÆ‡Øç!"); 
            return; 
        }

        const entry = { 
            name, mobile, distId, level, selfPV, groupPV, totalPV, date, consistency, meeting, 
            id: Date.now(),
            timestamp: new Date().toISOString(),
            addedBy: loggedInUser.id
        };
        
        let entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
        entries.unshift(entry); 
        localStorage.setItem('nfvt_ucd_v2', JSON.stringify(entries));
        
        updateActivityLog('add', entry);
        displayData();
        
        ['downlineName', 'mobileNo', 'distId', 'selfPV', 'groupPV'].forEach(id => document.getElementById(id).value = '');
        document.getElementById('consistency').value = 'Yes';
        document.getElementById('meeting').value = 'Yes';
    }

    function updateActivityLog(action, data) {
        let log = JSON.parse(localStorage.getItem('nfvt_activity_log')) || [];
        log.unshift({
            action,
            data,
            timestamp: new Date().toISOString(),
            user: loggedInUser.name
        });
        
        if (log.length > 1000) log = log.slice(0, 1000);
        localStorage.setItem('nfvt_activity_log', JSON.stringify(log));
    }

    function editEntry(id) {
        const entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
        const entry = entries.find(e => e.id === id);
        
        if (entry) {
            document.getElementById('editId').value = entry.id;
            document.getElementById('editName').value = entry.name;
            document.getElementById('editMobile').value = entry.mobile;
            document.getElementById('editSelfPV').value = entry.selfPV;
            document.getElementById('editGroupPV').value = entry.groupPV;
            document.getElementById('editDate').value = entry.date;
            document.getElementById('editConsistency').value = entry.consistency;
            document.getElementById('editMeeting').value = entry.meeting;
            
            document.getElementById('editModal').style.display = 'flex';
        }
    }

    function saveEdit() {
        const id = parseInt(document.getElementById('editId').value);
        let entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
        const idx = entries.findIndex(e => e.id === id);
        
        if (idx > -1) {
            const oldEntry = {...entries[idx]};
            
            entries[idx].name = document.getElementById('editName').value;
            entries[idx].mobile = document.getElementById('editMobile').value;
            entries[idx].selfPV = parseFloat(document.getElementById('editSelfPV').value) || 0;
            entries[idx].groupPV = parseFloat(document.getElementById('editGroupPV').value) || 0;
            entries[idx].totalPV = entries[idx].selfPV + entries[idx].groupPV;
            entries[idx].date = document.getElementById('editDate').value;
            entries[idx].consistency = document.getElementById('editConsistency').value;
            entries[idx].meeting = document.getElementById('editMeeting').value;
            entries[idx].lastModified = new Date().toISOString();
            entries[idx].modifiedBy = loggedInUser.id;
            
            localStorage.setItem('nfvt_ucd_v2', JSON.stringify(entries));
            updateActivityLog('edit', { old: oldEntry, new: entries[idx] });
            
            displayData();
            closeEditModal();
            
            alert(currentLanguage === 'en' 
                ? '‚úÖ Member details updated successfully!' 
                : '‚úÖ ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç ‡Æµ‡Æø‡Æµ‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø‡Æï‡Æ∞‡ÆÆ‡Ææ‡Æï ‡Æ™‡ØÅ‡Æ§‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ!');
        }
    }

    function closeEditModal() {
        document.getElementById('editModal').style.display = 'none';
    }

    function displayData() {
        const tableBody = document.getElementById('tableBody');
        const entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
        tableBody.innerHTML = '';
        let totalTeamPV = 0;
        let alertCount = 0;
        
        entries.forEach(item => {
            totalTeamPV += item.totalPV;
            
            let rowClass = '';
            let statusBadges = '';
            
            // Check for inactive ID (highest priority)
            if (item.selfPV < 30) {
                rowClass = 'inactive-warning';
                statusBadges += currentLanguage === 'en'
                    ? '<span style="background: #fee2e2; color: #dc2626; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; margin-right: 3px;">üö® INACTIVE</span>'
                    : '<span style="background: #fee2e2; color: #dc2626; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; margin-right: 3px;">üö® ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Æ±‡Øç‡Æ±‡Æ§‡ØÅ</span>';
                alertCount++;
            } 
            // Check for low PV
            else if (item.selfPV < 100) {
                rowClass = 'low-pv-warning';
                statusBadges += currentLanguage === 'en'
                    ? '<span style="background: #fed7aa; color: #ea580c; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; margin-right: 3px;">üìä LOW PV</span>'
                    : '<span style="background: #fed7aa; color: #ea580c; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; margin-right: 3px;">üìä ‡Æï‡ØÅ‡Æ±‡Øà‡Æ®‡Øç‡Æ§ PV</span>';
                alertCount++;
            } else {
                rowClass = 'high-pv';
            }
            
            // Check for low Group PV
            if (item.groupPV < 2600) {
                if (rowClass === 'high-pv') rowClass = 'low-group-pv';
                statusBadges += currentLanguage === 'en'
                    ? '<span style="background: #fef3c7; color: #92400e; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; margin-right: 3px;">‚ö†Ô∏è LOW GRP</span>'
                    : '<span style="background: #fef3c7; color: #92400e; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; margin-right: 3px;">‚ö†Ô∏è ‡Æï‡ØÅ‡Æ±‡Øà‡Æ®‡Øç‡Æ§ ‡Æï‡ØÅ‡Æ¥‡ØÅ</span>';
                alertCount++;
            }
            
            if (item.consistency === "No") {
                if (rowClass === '') rowClass = 'no-consistency';
                statusBadges += currentLanguage === 'en'
                    ? '<span style="background: #fee2e2; color: #991b1b; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; margin-right: 3px;">‚ùå NO 100PV</span>'
                    : '<span style="background: #fee2e2; color: #991b1b; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; margin-right: 3px;">‚ùå 100PV ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà</span>';
                alertCount++;
            }
            
            if (item.meeting === "No") {
                if (rowClass === '' && item.selfPV >= 100) rowClass = 'no-meeting';
                statusBadges += currentLanguage === 'en'
                    ? '<span style="background: #e0e7ff; color: #4f46e5; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; margin-right: 3px;">üîî MEETING</span>'
                    : '<span style="background: #e0e7ff; color: #4f46e5; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; margin-right: 3px;">üîî ‡Æï‡ØÇ‡Æü‡Øç‡Æü‡ÆÆ‡Øç</span>';
                alertCount++;
            }
            
            const waLink = `https://wa.me/91${item.mobile}`;
            
            tableBody.innerHTML += `<tr class="${rowClass}">
                    <td><strong style="color: #1e293b;">${item.name}</strong><br><small style="color: #64748b;">${item.distId}</small></td>
                    <td><strong>${item.mobile}</strong></td>
                    <td><span style="background: #ddd6fe; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 700; color: #5b21b6;">${item.level}</span></td>
                    <td><strong style="color: ${item.selfPV >= 100 ? '#059669' : (item.selfPV >= 30 ? '#f59e0b' : '#dc2626')};">${item.selfPV}</strong></td>
                    <td><strong style="color: ${item.groupPV >= 2600 ? '#059669' : '#f59e0b'};">${item.groupPV}</strong></td>
                    <td><strong style="font-size: 15px; color: #1e293b;">${item.totalPV}</strong></td>
                    <td>${item.date}</td>
                    <td><span style="background: ${item.consistency === 'Yes' ? '#dcfce7' : '#fee2e2'}; color: ${item.consistency === 'Yes' ? '#166534' : '#991b1b'}; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 700;">${item.consistency}</span></td>
                    <td><span style="background: ${item.meeting === 'Yes' ? '#dbeafe' : '#fef3c7'}; color: ${item.meeting === 'Yes' ? '#1e40af' : '#92400e'}; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 700;">${item.meeting}</span></td>
                    <td style="min-width: 150px;">${statusBadges || '<span style="color: #10b981; font-weight: 700;">‚úÖ</span>'}</td>
                    <td>
                        <button class="edit-btn" onclick="editEntry(${item.id})" title="${currentLanguage === 'en' ? 'Edit' : '‡Æ§‡Æø‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ'}">‚úèÔ∏è</button>
                        <button class="delete-btn" onclick="deleteEntry(${item.id})" title="${currentLanguage === 'en' ? 'Delete' : '‡Æ®‡ØÄ‡Æï‡Øç‡Æï‡ØÅ'}">‚ùå</button>
                    </td>
                    <td><a href="${waLink}" target="_blank" class="wa-link">üì± WA</a></td>
                </tr>`;
        });
        
        const statsText = currentLanguage === 'en'
            ? `Total Team PV: ${totalTeamPV.toFixed(2)} | Members: ${entries.length} | üîî Alerts: ${alertCount}`
            : `‡ÆÆ‡Øä‡Æ§‡Øç‡Æ§ ‡Æï‡ØÅ‡Æ¥‡ØÅ PV: ${totalTeamPV.toFixed(2)} | ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øç: ${entries.length} | üîî ‡Æé‡Æö‡Øç‡Æö‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Øà‡Æï‡Æ≥‡Øç: ${alertCount}`;
        
        document.getElementById('totalStats').querySelector('.lang-text').textContent = statsText;
    }

    function deleteEntry(id) {
        const confirmMsg = currentLanguage === 'en' 
            ? "‚ö†Ô∏è Delete this member?" 
            : "‚ö†Ô∏è ‡Æá‡Æ®‡Øç‡Æ§ ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øà ‡Æ®‡ØÄ‡Æï‡Øç‡Æï‡Æµ‡Ææ?";
        
        if(confirm(confirmMsg)) {
            let entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
            let trash = JSON.parse(localStorage.getItem('nfvt_trash')) || [];
            const idx = entries.findIndex(e => e.id === id);
            
            if (idx > -1) {
                trash.push(entries[idx]); 
                updateActivityLog('delete', entries[idx]);
                entries.splice(idx, 1);
                localStorage.setItem('nfvt_ucd_v2', JSON.stringify(entries));
                localStorage.setItem('nfvt_trash', JSON.stringify(trash));
                displayData();
            }
        }
    }

    function showReports() {
        const entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
        const now = new Date();
        const currentMonth = now.getMonth();
        const currentYear = now.getFullYear();
        
        const monthStart = new Date(currentYear, currentMonth, 2);
        const monthEnd = new Date(currentYear, currentMonth + 1, 2);
        
        const monthlyEntries = entries.filter(e => {
            const entryDate = new Date(e.date);
            return entryDate >= monthStart && entryDate < monthEnd;
        });
        
        const dailyData = {};
        entries.forEach(e => {
            if (!dailyData[e.date]) {
                dailyData[e.date] = [];
            }
            dailyData[e.date].push(e);
        });
        
        let daily8PercentCount = 0;
        Object.keys(dailyData).forEach(date => {
            const dayTotal = dailyData[date].reduce((sum, e) => sum + e.totalPV, 0);
            const target = entries.length * dailyTargetPercentage;
            if (dayTotal >= target) {
                daily8PercentCount++;
            }
        });
        
        const consistencyData = entries.filter(e => e.consistency === 'Yes');
        
        const reportHTML = `
            <div style="text-align: left;">
                <h3 style="color: #1e293b; margin-bottom: 15px;">
                    ${currentLanguage === 'en' ? 'üìä Monthly Report' : 'üìä ‡ÆÆ‡Ææ‡Æ§‡Ææ‡Æ®‡Øç‡Æ§‡Æø‡Æ∞ ‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà'}
                </h3>
                
                <div style="background: #f0f9ff; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                    <strong style="color: #0369a1;">${currentLanguage === 'en' ? 'Total Members:' : '‡ÆÆ‡Øä‡Æ§‡Øç‡Æ§ ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øç:'}</strong> ${entries.length}<br>
                    <strong style="color: #0369a1;">${currentLanguage === 'en' ? 'Monthly Entries:' : '‡ÆÆ‡Ææ‡Æ§‡Ææ‡Æ®‡Øç‡Æ§‡Æø‡Æ∞ ‡Æâ‡Æ≥‡Øç‡Æ≥‡ØÄ‡Æü‡ØÅ‡Æï‡Æ≥‡Øç:'}</strong> ${monthlyEntries.length}<br>
                    <strong style="color: #0369a1;">${currentLanguage === 'en' ? 'Total Team PV:' : '‡ÆÆ‡Øä‡Æ§‡Øç‡Æ§ ‡Æï‡ØÅ‡Æ¥‡ØÅ PV:'}</strong> ${entries.reduce((sum, e) => sum + e.totalPV, 0).toFixed(2)}
                </div>
                
                <div style="background: #ecfdf5; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                    <strong style="color: #047857;">${currentLanguage === 'en' ? 'üéØ Daily ' + dailyTargetPercentage + '% Target Achievement:' : 'üéØ ‡Æ§‡Æø‡Æ©‡Æö‡Æ∞‡Æø ' + dailyTargetPercentage + '% ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ ‡Æö‡Ææ‡Æ§‡Æ©‡Øà:'}</strong> ${daily8PercentCount} ${currentLanguage === 'en' ? 'days' : '‡Æ®‡Ææ‡Æü‡Øç‡Æï‡Æ≥‡Øç'}
                    <br><small style="color: #064e3b;">${currentLanguage === 'en' ? 'Days when team achieved ' + dailyTargetPercentage + '% daily target' : '‡Æï‡ØÅ‡Æ¥‡ØÅ ' + dailyTargetPercentage + '% ‡Æ§‡Æø‡Æ©‡Æö‡Æ∞‡Æø ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡Øà ‡ÆÖ‡Æü‡Øà‡Æ®‡Øç‡Æ§ ‡Æ®‡Ææ‡Æü‡Øç‡Æï‡Æ≥‡Øç'}</small>
                    <br><br>
                    <button onclick="updateDailyTarget()" style="background: #10b981; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 700;">
                        ${currentLanguage === 'en' ? '‚öôÔ∏è Update ' + dailyTargetPercentage + '% Target' : '‚öôÔ∏è ' + dailyTargetPercentage + '% ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡Øà ‡Æ™‡ØÅ‡Æ§‡ØÅ‡Æ™‡Øç‡Æ™‡Æø'}
                    </button>
                </div>
                
                <div style="background: #fef3c7; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                    <strong style="color: #92400e;">${currentLanguage === 'en' ? '‚úÖ 100PV Consistency Achieved:' : '‚úÖ 100PV ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡ÆÖ‡Æü‡Øà‡Æ®‡Øç‡Æ§‡Æµ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç:'}</strong> ${consistencyData.length} ${currentLanguage === 'en' ? 'members' : '‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øç'}
                    <br><br>
                    ${consistencyData.map(e => `<div style="margin: 5px 0;"><strong>${e.name}</strong> - ${currentLanguage === 'en' ? 'Achieved on' : '‡ÆÖ‡Æü‡Øà‡Æ®‡Øç‡Æ§ ‡Æ§‡Øá‡Æ§‡Æø'}: ${e.date}</div>`).join('')}
                </div>
            </div>
        `;
        
        document.getElementById('reportsContent').innerHTML = reportHTML;
        document.getElementById('reportsModal').style.display = 'flex';
    }

    function updateDailyTarget() {
        const newTarget = prompt(currentLanguage === 'en' 
            ? `Enter new daily target percentage (current: ${dailyTargetPercentage}%):`
            : `‡Æ™‡ØÅ‡Æ§‡Æø‡ÆØ ‡Æ§‡Æø‡Æ©‡Æö‡Æ∞‡Æø ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ ‡Æö‡Æ§‡Æµ‡ØÄ‡Æ§‡Æ§‡Øç‡Æ§‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç (‡Æ§‡Æ±‡Øç‡Æ™‡Øã‡Æ§‡Øà‡ÆØ: ${dailyTargetPercentage}%):`);
        
        if (newTarget && !isNaN(newTarget) && newTarget > 0 && newTarget <= 100) {
            dailyTargetPercentage = parseFloat(newTarget);
            localStorage.setItem('dailyTargetPercentage', dailyTargetPercentage);
            alert(currentLanguage === 'en' 
                ? `‚úÖ Daily target updated to ${dailyTargetPercentage}%`
                : `‚úÖ ‡Æ§‡Æø‡Æ©‡Æö‡Æ∞‡Æø ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ ${dailyTargetPercentage}% ‡ÆÜ‡Æï ‡Æ™‡ØÅ‡Æ§‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ`);
            showReports();
        }
    }

    function closeReportsModal() {
        document.getElementById('reportsModal').style.display = 'none';
    }

    function downloadMonthlyReport() {
        const entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
        const now = new Date();
        
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        doc.setFontSize(18);
        doc.setTextColor(191, 149, 63);
        doc.text("NFVT Team Monthly Report", 14, 15);
        
        doc.setFontSize(10);
        doc.setTextColor(0, 0, 0);
        doc.text(`Generated: ${now.toLocaleDateString()}`, 14, 22);
        doc.text(`Report By: ${loggedInUser.name} (ID: ${loggedInUser.id})`, 14, 28);
        
        const totalPV = entries.reduce((sum, e) => sum + e.totalPV, 0);
        doc.text(`Total Members: ${entries.length} | Team PV: ${totalPV.toFixed(2)}`, 14, 34);
        
        const rows = entries.map(e => [
            e.name, 
            e.distId, 
            e.mobile, 
            e.selfPV, 
            e.groupPV,
            e.totalPV, 
            e.date,
            e.consistency,
            e.meeting
        ]);
        
        doc.autoTable({ 
            head: [['Name', 'ID', 'Mobile', 'Self PV', 'Group PV', 'Total', 'Date', '100PV', 'Meeting']], 
            body: rows, 
            startY: 40,
            styles: { fontSize: 7 },
            headStyles: { fillColor: [30, 41, 59] }
        });
        
        doc.save(`NFVT_Monthly_Report_${loggedInUser.id}_${now.toISOString().split('T')[0]}.pdf`);
    }

    function downloadPDF() {
        const entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
        const now = new Date();
        
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        doc.setFontSize(18);
        doc.setTextColor(191, 149, 63);
        doc.text("NFVT Team Followup Report", 14, 15);
        
        doc.setFontSize(10);
        doc.setTextColor(0, 0, 0);
        doc.text(`Generated: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`, 14, 22);
        doc.text(`Report By: ${loggedInUser.name} (ID: ${loggedInUser.id})`, 14, 28);
        
        const totalPV = entries.reduce((sum, e) => sum + e.totalPV, 0);
        const alerts = entries.filter(e => e.selfPV < 30 || e.meeting === 'No' || e.groupPV < 2600).length;
        doc.text(`Members: ${entries.length} | Team PV: ${totalPV.toFixed(2)} | Alerts: ${alerts}`, 14, 34);
        
        const rows = entries.map(e => [
            e.name, 
            e.distId, 
            e.mobile, 
            e.selfPV, 
            e.groupPV,
            e.totalPV, 
            e.date,
            e.consistency,
            e.meeting
        ]);
        
        doc.autoTable({ 
            head: [['Name', 'ID', 'Mobile', 'Self', 'Group', 'Total', 'Date', '100PV', 'Mtg']], 
            body: rows, 
            startY: 40,
            styles: { fontSize: 8 },
            headStyles: { fillColor: [30, 41, 59] }
        });
        
        doc.save(`NFVT_Report_${loggedInUser.id}_${now.toISOString().split('T')[0]}.pdf`);
    }

    function downloadCSV() {
        const entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
        const now = new Date();
        
        let csv = `"NFVT Team Followup Report"\n`;
        csv += `"Generated: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}"\n`;
        csv += `"Report By: ${loggedInUser.name} (ID: ${loggedInUser.id})"\n\n`;
        csv += "Name,ID,Mobile,Level,SelfPV,GroupPV,TotalPV,Date,100PV_CNC,Meeting,Timestamp\n";
        
        entries.forEach(e => csv += `"${e.name}","${e.distId}","${e.mobile}","${e.level}","${e.selfPV}","${e.groupPV}","${e.totalPV}","${e.date}","${e.consistency}","${e.meeting}","${e.timestamp || ''}"\n`);
        
        const b = new Blob([csv], {type:'text/csv'});
        const a = document.createElement('a'); 
        a.href=URL.createObjectURL(b); 
        a.download=`NFVT_Report_${loggedInUser.id}_${now.toISOString().split('T')[0]}.csv`; 
        a.click();
    }

    function toggleTrash() {
        const ts = document.getElementById('trashSection');
        ts.style.display = (ts.style.display === 'none' || ts.style.display === '') ? 'block' : 'none';
        
        if(ts.style.display === 'block') {
            const trash = JSON.parse(localStorage.getItem('nfvt_trash')) || [];
            document.getElementById('trashBody').innerHTML = trash.map(i => 
                `<tr style="background: white;">
                    <td><strong>${i.name}</strong></td>
                    <td>${i.distId}</td>
                    <td>
                        <button onclick="restoreEntry(${i.id})" style="background: #10b981; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-weight: 700; margin-right: 5px;">
                            ${currentLanguage === 'en' ? '‚Ü©Ô∏è Restore' : '‚Ü©Ô∏è ‡ÆÆ‡ØÄ‡Æü‡Øç‡Æü‡ÆÆ‡Øà'}
                        </button>
                        <button onclick="permanentDelete(${i.id})" style="background: #7f1d1d; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-weight: 700;">
                            ${currentLanguage === 'en' ? 'üóëÔ∏è Delete Forever' : 'üóëÔ∏è ‡Æ®‡Æø‡Æ∞‡Æ®‡Øç‡Æ§‡Æ∞‡ÆÆ‡Ææ‡Æï ‡Æ®‡ØÄ‡Æï‡Øç‡Æï‡ØÅ'}
                        </button>
                    </td>
                </tr>`
            ).join('');
        }
    }

    function permanentDelete(id) {
        const confirmMsg = currentLanguage === 'en'
            ? "‚ö†Ô∏è PERMANENT DELETE!\n\nThis cannot be undone. Are you sure?"
            : "‚ö†Ô∏è ‡Æ®‡Æø‡Æ∞‡Æ®‡Øç‡Æ§‡Æ∞ ‡Æ®‡ØÄ‡Æï‡Øç‡Æï‡ØÅ‡Æ§‡Æ≤‡Øç!\n\n‡Æá‡Æ§‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Øç‡Æ§‡Æµ‡Æø‡Æ∞‡Øç‡Æï‡Øç‡Æï ‡ÆÆ‡ØÅ‡Æü‡Æø‡ÆØ‡Ææ‡Æ§‡ØÅ. ‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æâ‡Æ±‡ØÅ‡Æ§‡Æø‡ÆØ‡Ææ‡Æï ‡Æâ‡Æ≥‡Øç‡Æ≥‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Ææ?";
        
        if(confirm(confirmMsg)) {
            let trash = JSON.parse(localStorage.getItem('nfvt_trash')) || [];
            const idx = trash.findIndex(e => e.id === id);
            
            if (idx > -1) {
                trash.splice(idx, 1);
                localStorage.setItem('nfvt_trash', JSON.stringify(trash));
                toggleTrash();
                setTimeout(() => toggleTrash(), 100);
            }
        }
    }

    function emptyTrash() {
        const trash = JSON.parse(localStorage.getItem('nfvt_trash')) || [];
        if (trash.length === 0) {
            alert(currentLanguage === 'en' ? "Trash is empty!" : "‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Øà ‡Æï‡Ææ‡Æ≤‡Æø‡ÆØ‡Ææ‡Æï ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æ§‡ØÅ!");
            return;
        }
        
        const confirmMsg = currentLanguage === 'en'
            ? `‚ö†Ô∏è EMPTY TRASH!\n\nPermanently delete all ${trash.length} members?`
            : `‚ö†Ô∏è ‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Øà‡ÆØ‡Øà ‡Æï‡Ææ‡Æ≤‡Æø ‡Æö‡ØÜ‡ÆØ‡Øç!\n\n‡ÆÖ‡Æ©‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ${trash.length} ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øà‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡Æ®‡Æø‡Æ∞‡Æ®‡Øç‡Æ§‡Æ∞‡ÆÆ‡Ææ‡Æï ‡Æ®‡ØÄ‡Æï‡Øç‡Æï‡Æµ‡Ææ?`;
        
        if(confirm(confirmMsg)) {
            localStorage.setItem('nfvt_trash', JSON.stringify([]));
            toggleTrash();
            alert(currentLanguage === 'en' ? "‚úÖ Trash emptied!" : "‚úÖ ‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Øà ‡Æï‡Ææ‡Æ≤‡Æø‡ÆØ‡Ææ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ!");
        }
    }

    function restoreEntry(id) {
        let entries = JSON.parse(localStorage.getItem('nfvt_ucd_v2')) || [];
        let trash = JSON.parse(localStorage.getItem('nfvt_trash')) || [];
        const idx = trash.findIndex(e => e.id === id);
        
        if (idx > -1) {
            entries.unshift(trash[idx]); 
            updateActivityLog('restore', trash[idx]);
            trash.splice(idx, 1);
            localStorage.setItem('nfvt_ucd_v2', JSON.stringify(entries));
            localStorage.setItem('nfvt_trash', JSON.stringify(trash));
            displayData(); 
            toggleTrash(); 
            setTimeout(() => toggleTrash(), 100);
        }
    }

    function filterTable() {
        const q = document.getElementById("searchInput").value.toUpperCase();
        const r = document.getElementById("tableBody").getElementsByTagName("tr");
        for (let row of r) { 
            row.style.display = row.innerText.toUpperCase().includes(q) ? "" : "none"; 
        }
    }

    window.addEventListener('load', () => {
        const saved = localStorage.getItem('dailyTargetPercentage');
        if (saved) {
            dailyTargetPercentage = parseFloat(saved);
        }
    });
</script>
</body>
</html>
